rules_version = '2';

// Temel Kurallar:
// 1. **upload/** klasörü altındaki dosyalara herkesin okuma izni vardır.
//    Bu, profil resimleri, gönderi resimleri vb. dosyaların uygulama
//    içinde herkes tarafından görüntülenebilmesini sağlar.
// 2. **upload/** klasörüne dosya yazma (yükleme) izni sadece kimliği doğrulanmış
//    kullanıcılara aittir. Bu, yetkisiz dosya yüklemelerini engeller.
// 3. Yazma işlemi sırasında, yüklenen dosyanın boyutunun 15MB'tan küçük
//    olması ve bir resim veya video dosyası olması kontrol edilir.
service firebase.storage {
  match /b/{bucket}/o {
    match /upload/{allPaths=**} {
      allow read; // Allow anyone to read files in the 'upload' directory.
      allow write: if request.auth != null && 
                      request.resource.size < 15 * 1024 * 1024 && // Max 15MB
                      (request.resource.contentType.matches('image/.*') || 
                       request.resource.contentType.matches('video/.*'));
    }
  }
}
