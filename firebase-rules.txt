// Bu kurallar, Firebase projenizin Storage bölümündeki "Rules" sekmesine yapıştırılmalıdır.
// Bu, uygulamanızın güvenli bir şekilde resim yüklemesine ve göstermesine olanak tanır.

rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // Kullanıcı avatarları için kurallar
    // /avatars/{userId} yolundaki dosyalara erişimi yönetir
    match /avatars/{userId} {
      // Herkesin avatar resimlerini okumasına (görmesine) izin ver
      allow read: if true;
      
      // Sadece giriş yapmış ve kimliği eşleşen kullanıcının
      // kendi avatarını yazmasına (yüklemesine/güncellemesine) izin ver.
      allow write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Kullanıcı gönderileri için kurallar
    // /posts/{userId}/ altındaki tüm dosyalara erişimi yönetir
    match /posts/{userId}/{allPaths=**} {
      // Herkesin gönderi resimlerini okumasına (görmesine) izin ver
      allow read: if true;
      
      // Sadece giriş yapmış ve kimliği eşleşen kullanıcının
      // kendi gönderi klasörüne yazmasına (yüklemesine) izin ver.
      allow write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
